<Window
    x:Class="BatchRename.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:BatchRename"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Batch Rename"
    Width="720"
    Height="720"
    MinWidth="600"
    MinHeight="600"
    Icon="App.ico"
    WindowStartupLocation="CenterScreen"
    Style="{StaticResource ModernWindow}"
    mc:Ignorable="d">

    <Window.Resources>
        <!-- Font embedding for reliable icon display -->
        <FontFamily x:Key="IconFont">
            pack://application:,,,/fonts/#Segoe MDL2 Assets
        </FontFamily>

        <!-- Alternative: Use Material Design Icons if preferred -->
        <!--
        <FontFamily x:Key="IconFont">
            pack://application:,,,/MaterialDesignThemes.Wpf;component/Resources/#Material Design Icons
        </FontFamily>
        -->
    </Window.Resources>

    <Grid Background="{StaticResource BackgroundPrimaryBrush}" Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" MinHeight="280" />
            <RowDefinition Height="12" />
            <RowDefinition Height="*" MinHeight="280" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Rules Section -->
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="40" />
            </Grid.ColumnDefinitions>

            <!-- Rules Header -->
            <Grid Grid.Row="0" Grid.ColumnSpan="2" Margin="0,0,0,12">
                <TextBlock Text="Rules" Style="{StaticResource SubheaderTextStyle}" 
                           HorizontalAlignment="Left" VerticalAlignment="Center" FontSize="16" FontWeight="Bold" Margin="5,0,0,0" />
                <TextBlock Text="{Binding Rules.Count, StringFormat='{}{0} rules'}" 
                           Style="{StaticResource CaptionTextStyle}" 
                           HorizontalAlignment="Right" VerticalAlignment="Center" />
            </Grid>

            <!-- Rules DataGrid -->
            <DataGrid
                x:Name="DgRules"
                Grid.Row="1"
                Grid.Column="0"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                ItemsSource="{Binding Rules}"
                MouseDoubleClick="DgRules_MouseDoubleClick"
                MouseUp="DgRules_MouseUp"
                Margin="0,0,12,0">
                <DataGrid.Columns>
                    <DataGridTextColumn
                        Width="90"
                        Binding="{Binding Path=Name}"
                        Header="Rule"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Path=Description}"
                        Header="Description"
                        IsReadOnly="True" />
                </DataGrid.Columns>
            </DataGrid>

            <!-- Rules Action Buttons -->
            <StackPanel Grid.Row="1" Grid.Column="1" VerticalAlignment="Top">
                <Button x:Name="BtnAddRule"
                        Click="BtnAddRule_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Add Rule">
                    <TextBlock Text="&#xE710;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>

                <Button x:Name="BtnRemoveRule"
                        Click="BtnRemoveRule_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Remove Rule"
                        Margin="0,6,0,0">
                    <TextBlock Text="&#xE711;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource ErrorBrush}"/>
                </Button>

                <Rectangle Height="1" Fill="{StaticResource BorderPrimaryBrush}" Margin="4,12,4,12" />

                <Button x:Name="BtnUp"
                        Click="BtnUp_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Move Rule Up"
                        Margin="0,0,0,6">
                    <TextBlock Text="&#xE70E;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>

                <Button x:Name="BtnDown"
                        Click="BtnDown_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Move Rule Down"
                        Margin="0,0,0,6">
                    <TextBlock Text="&#xE70D;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>

                <Rectangle Height="1" Fill="{StaticResource BorderPrimaryBrush}" Margin="4,12,4,12" />

                <Button x:Name="BtnAddRuleFromFile"
                        Click="BtnAddRuleFromFile_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Import Rules from File"
                        Margin="0,0,0,6">
                    <TextBlock Text="&#xE8F4;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>

                <Button x:Name="BtnSaveRuleToFile"
                        Click="BtnSaveRuleToFile_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Export Rules to File">
                    <TextBlock Text="&#xE74E;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Section Separator -->
        <Rectangle Grid.Row="2" Style="{StaticResource SectionDivider}" />

        <!-- Files Section -->
        <Grid Grid.Row="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="40" />
            </Grid.ColumnDefinitions>

            <!-- Files Header -->
            <Grid Grid.Row="0" Grid.ColumnSpan="2" Margin="0,0,0,12">
                <TextBlock Text="Files" Style="{StaticResource SubheaderTextStyle}" 
                           HorizontalAlignment="Left" VerticalAlignment="Center" FontSize="16" FontWeight="Bold" Margin="5,0,0,0" />
                <TextBlock Text="{Binding Files.Count, StringFormat='{}{0} files'}" 
                           Style="{StaticResource CaptionTextStyle}" 
                           HorizontalAlignment="Right" VerticalAlignment="Center" />
            </Grid>

            <!-- Files DataGrid -->
            <DataGrid
                x:Name="DgFiles"
                Grid.Row="1"
                Grid.Column="0"
                AllowDrop="True"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                CanUserSortColumns="False"
                Drop="DgFiles_Drop"
                ItemsSource="{Binding Files}"
                MouseDoubleClick="DgFiles_MouseDoubleClick"
                Margin="0,0,12,0">
                <DataGrid.Columns>
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Name}"
                        Header="Original Name"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding NewName}"
                        Header="New Name" />
                    <DataGridTextColumn
                        Width="80"
                        Binding="{Binding Status}"
                        Header="Status"
                        IsReadOnly="True" />
                </DataGrid.Columns>
            </DataGrid>

            <!-- Files Action Buttons -->
            <StackPanel Grid.Row="1" Grid.Column="1" VerticalAlignment="Top">
                <Button x:Name="BtnAddFiles"
                        Click="BtnAddFiles_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Add Files"
                        Margin="0,0,0,6">
                    <TextBlock Text="&#xE710;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>

                <Button x:Name="BtnRemoveFile"
                        Click="BtnRemoveFile_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Remove File"
                        Margin="0,0,0,6">
                    <TextBlock Text="&#xE711;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource ErrorBrush}"/>
                </Button>

                <Rectangle Height="1" Fill="{StaticResource BorderPrimaryBrush}" Margin="4,12,4,12" />

                <Button x:Name="BtnSortUp"
                        Click="BtnSortUp_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Sort Files A-Z"
                        Margin="0,0,0,6">
                    <TextBlock Text="&#xE70E;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>

                <Button x:Name="BtnSortDown"
                        Click="BtnSortDown_Click"
                        Style="{StaticResource IconButton}"
                        ToolTip="Sort Files Z-A">
                    <TextBlock Text="&#xE70D;" 
                               FontFamily="{StaticResource IconFont}"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Bottom Action Bar -->
        <Border Grid.Row="4" Background="{StaticResource BackgroundSecondaryBrush}"
                BorderBrush="{StaticResource BorderPrimaryBrush}" BorderThickness="0,1,0,0"
                Margin="-20,20,-20,-20" Padding="20,20,20,20">
            <Grid>
                <!-- Left side buttons -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                    <Button
                        x:Name="BtnClearRules"
                        Click="BtnClearRules_Click"
                        Content="Clear Rules"
                        MinWidth="100"
                        Margin="0,0,12,0" />
                    <Button
                        x:Name="BtnClearFiles"
                        Click="BtnClearFiles_Click"
                        Content="Clear Files"
                        MinWidth="100" />
                </StackPanel>

                <!-- Right side primary action -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button
                        x:Name="BtnRename"
                        Click="BtnRename_Click"
                        Content="Rename Files"
                        Style="{StaticResource SecondaryButton}"
                        MinWidth="120" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>